<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Gestão de Contratos{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@latest/font/bootstrap-icons.css">



    <!-- Bootstrap CSS (CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">


    <!-- Estilo personalizado opcional -->
    <style>
        body {
            background-color: #f8f9fa;
        }

        .nav-tabs .nav-link {
            border: none;
            border-bottom: 2px solid transparent;
            color: #000000;
            font-weight: 500;
            font-family:
        }
        .navbar .input-group {
            width: 300px;
        }

        .nav-tabs .nav-link.active {
            border-bottom: 2px solid #0d6efd;
            color: #000000;
            background-color: transparent;
        }
        #notification-badge {
            width: 10px;
            height: 10px;
        }

    </style>

    {% block extra_css %}{% endblock %}
</head>
<body>
    {% include 'header.html' %}
    <!-- Conteúdo principal centralizado -->
    <main class="px-4 py-5">
    {% block content %}
    <!-- Conteúdo específico da página -->
    {% endblock %}
</main>
    {% include 'footer.html' %}


    <!-- Bootstrap JS (CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery UI -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script><link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/hot-sneaks/jquery-ui.css">

    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
<!-- jQuery UI - Localização pt-BR -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-datepicker/1.13.0/i18n/datepicker-pt-BR.min.js"></script>
    {% block extra_js %}{% endblock %}

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function () {
  function carregarNotificacoes() {
    $.get("/api/notificacoes_nao_lidas/", function (data) {
      const notificacoes = data.notificacoes;
      const bolinha = $("#bolinha");
      const lista = $("#notificacaoLista");

      // Limpa a lista
      lista.empty();

      if (notificacoes.length > 0) {
        // Exibe a bolinha
        bolinha.removeClass("d-none");

        // Adiciona cada notificação
        notificacoes.forEach((item) => {
  const notificacaoHtml = `
            <li>
              <a href="/visualizacaocontrato/${item.contract_id}/" class="dropdown-item notificacao-item" data-id="${item.id}">
                <strong>${item.notify_name}</strong><br>
                <small class="text-muted">${item.contract_title} – ${item.reminder_date}</small>
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
          `;
          lista.append(notificacaoHtml);
        });

      } else {
        bolinha.addClass("d-none");

        lista.append(`
          <li class="text-center text-muted">Nenhuma notificação</li>
          <li><hr class="dropdown-divider"></li>
        `);
      }

      // Adiciona o botão de novo lembrete
      lista.append(`
        <li>
          <a class="dropdown-item text-primary fw-semibold text-center" href="{% url 'notificacoes' %}">
            <i class="bi bi-plus-lg me-1"></i>Novo Lembrete
          </a>
        </li>
      `);
    });
  }

  // Chama a função quando a página carregar
  carregarNotificacoes();

  // Oculta a bolinha quando o dropdown for aberto
  $("#dropdownNotificacoes").on("click", function () {
    $("#bolinha").addClass("d-none");
  });
});
</script>


</body>
</html>
